<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AgroVetor - Mapeamento e Controle</title>
    
    <!-- Bibliotecas de Mapa (Leaflet) -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

    <!-- Biblioteca para ler Shapefiles (shpjs) -->
    <script src="https://unpkg.com/shpjs@latest/dist/shp.js"></script>

    <!-- Estilos e Ícones -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <style>
        :root {
            --color-primary: #2e7d32;
            --color-primary-dark: #1b5e20;
            --color-primary-light: #e8f5e9;
            --color-accent: #4caf50;
            --color-bg: #f5f5f5;
            --color-surface: #ffffff;
            --color-text: #333333;
            --color-text-light: #555555;
            --color-white: #ffffff;
            --color-border: #e0e0e0;
            --color-danger: #d32f2f;
            --color-success: #388e3c;
            --color-warning: #f57c00;
            --color-info: #1976d2;
            --color-purple: #7b1fa2;
            --color-ai: #6a1b9a;
            --shadow-sm: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            --font-family: 'Poppins', -apple-system, BlinkMacSystemFont, sans-serif;
            --border-radius: 12px;
            --border-radius-lg: 16px;
            --border-radius-xl: 20px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        body { font-family: var(--font-family); background-color: var(--color-bg); margin: 0; }
        .card { background: var(--color-surface); padding: 24px; border-radius: var(--border-radius-lg); box-shadow: var(--shadow-sm); font-size: 16px; max-width: 1200px; margin: 0 auto 30px; border-left: 4px solid var(--color-accent); transition: var(--transition); position: relative; }
        .card h2 { color: var(--color-primary); margin-top: 0; margin-bottom: 24px; font-weight: 600; font-size: 22px; display: flex; align-items: center; gap: 12px; }
        .card h3 { color: var(--color-primary-dark); margin-top: 25px; margin-bottom: 10px; border-bottom: 2px solid var(--color-border); padding-bottom: 5px; display: flex; justify-content: space-between; align-items: center; }
        label { display: block; margin-top: 16px; font-weight: 500; color: var(--color-text-light); font-size: 14px; }
        input, select, textarea { width: 100%; padding: 12px 14px; margin-top: 8px; border-radius: var(--border-radius); border: 1px solid var(--color-border); font-size: 16px; transition: var(--transition); background-color: var(--color-bg); box-shadow: var(--shadow-sm); font-family: var(--font-family); color: var(--color-text); }
        .form-row { display: flex; flex-wrap: wrap; gap: 20px; margin-bottom: 16px; }
        .form-col { flex: 1; min-width: 200px; }
        button.save { margin-top: 24px; background: linear-gradient(to right, var(--color-primary), var(--color-accent)); color: var(--color-white); border: none; padding: 14px 24px; border-radius: var(--border-radius); font-size: 16px; font-weight: 600; cursor: pointer; box-shadow: var(--shadow-sm); transition: var(--transition); display: inline-flex; align-items: center; justify-content: center; gap: 10px; width: auto; max-width: 300px; }
        button.save:hover { transform: translateY(-2px); box-shadow: var(--shadow-md); }
        
        html { scroll-behavior: smooth; }
        body { display: flex; flex-direction: column; min-height: 100vh; }
        #appScreen { display: flex; flex-direction: column; flex: 1; }
        header { position: fixed; top: 0; left: 0; right: 0; height: 70px; background: linear-gradient(to right, var(--color-primary), var(--color-primary-dark)); color: var(--color-white); display: flex; align-items: center; justify-content: space-between; padding: 0 24px; box-shadow: var(--shadow-md); z-index: 1000; }
        header h1 { font-size: 20px; position: absolute; left: 50%; transform: translateX(-50%); }
        main.content { margin-top: 70px; padding: 20px; flex-grow: 1; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }

        #map { height: 60vh; width: 100%; border-radius: var(--border-radius); border: 1px solid var(--color-border); background-color: var(--color-bg); z-index: 1; }
        .map-controls { position: absolute; top: 10px; right: 10px; z-index: 1000; display: flex; flex-direction: column; gap: 10px; }
        .map-btn { background-color: var(--color-surface); border: 1px solid var(--color-border); color: var(--color-primary-dark); width: 40px; height: 40px; border-radius: 50%; cursor: pointer; transition: all 0.3s ease; display: flex; align-items: center; justify-content: center; font-size: 16px; box-shadow: var(--shadow-md); }
        .map-btn:hover { background-color: var(--color-primary-light); }
        .map-btn.active { background-color: var(--color-primary); color: var(--color-white); }
        .map-action-btn { background-color: var(--color-surface); border: 1px solid var(--color-border); color: var(--color-text-light); padding: 8px 12px; border-radius: var(--border-radius); cursor: pointer; transition: var(--transition); font-size: 14px; font-weight: 500; }
        .map-action-btn:hover { background-color: var(--color-primary-light); color: var(--color-primary); border-color: var(--color-primary); }
        #notification-panel { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); z-index: 1001; display: flex; flex-direction: column; gap: 10px; align-items: center; width: 90%; max-width: 500px;}
        .notification { background: var(--color-surface); color: var(--color-text); padding: 12px 20px; border-radius: var(--border-radius); box-shadow: var(--shadow-lg); display: flex; align-items: center; gap: 10px; font-weight: 500; transition: all 0.5s ease; opacity: 0; transform: translateY(20px); width: 100%; }
        .notification.show { opacity: 1; transform: translateY(0); }
        .notification.warning { border-left: 5px solid var(--color-warning); }
        .notification.danger { border-left: 5px solid var(--color-danger); animation: pulse-danger 2s infinite; }
        @keyframes pulse-danger { 0% { box-shadow: 0 0 0 0 color-mix(in srgb, var(--color-danger) 40%, transparent); } 70% { box-shadow: 0 0 0 10px color-mix(in srgb, var(--color-danger) 0%, transparent); } 100% { box-shadow: 0 0 0 0 color-mix(in srgb, var(--color-danger) 0%, transparent); } }
        .leaflet-popup-content { font-family: var(--font-family); }
        .leaflet-popup-content strong { color: var(--color-primary-dark); }
        .popup-input { width: 100%; padding: 8px; margin-top: 8px; border-radius: var(--border-radius); border: 1px solid var(--color-border); }
        .popup-button { width: 100%; padding: 10px; margin-top: 10px; border: none; border-radius: var(--border-radius); background-color: var(--color-primary); color: var(--color-white); font-weight: 600; cursor: pointer; }
        .talhao-alerta { fill-color: var(--color-danger); color: var(--color-danger); fill-opacity: 0.4; weight: 2; }
        .talhao-highlight { fill-color: var(--color-warning); color: var(--color-warning); fill-opacity: 0.6; weight: 3; }
        
        /* Adicione aqui o resto do seu CSS principal */

    </style>
</head>
<body>

    <!-- Simulação da estrutura do seu App -->
    <div id="appScreen">
        <header>
            <h1><i class="fas fa-leaf"></i> AgroVetor</h1>
            <!-- Seus outros botões de header aqui -->
        </header>
        <main class="content">
            <!-- Outras seções do seu app podem vir aqui -->

            <!-- MÓDULO DE MAPEAMENTO E CONTROLE DE PRAGAS -->
            <section id="mapeamentoControle" class="tab-content active card" style="border-left-color: var(--color-purple);" aria-label="Mapeamento e Controle">
                <h2 style="color: var(--color-purple);"><i class="fas fa-satellite-dish" style="color: var(--color-purple);"></i> Mapeamento e Controle de Pragas</h2>
            
                <div class="card" style="border-left-color: var(--color-purple);">
                    <h3>
                        <span><i class="fas fa-map-marked-alt"></i> Mapa Operacional</span>
                        <div class="map-header-actions">
                            <button id="btn-upload-shp" class="map-action-btn" title="Carregar Shapefile"><i class="fas fa-upload"></i> Carregar Mapa</button>
                            <input type="file" id="shapefileInput" accept=".zip" style="display: none;">
                        </div>
                    </h3>
                    <p>Use os botões no mapa para rastrear sua localização e marcar armadilhas.</p>
                    <div style="position: relative;">
                        <div id="map"></div>
                        <div class="map-controls">
                            <button id="btn-toggle-tracking" class="map-btn" title="Rastreamento em Tempo Real"><i class="fas fa-crosshairs"></i></button>
                            <button id="btn-place-trap" class="map-btn" title="Colocar Armadilha na Posição Atual"><i class="fas fa-bug"></i></button>
                        </div>
                    </div>
                </div>
            </section>

        </main>
    </div>

    <div id="notification-panel"></div>

    <script type="module" src="./app.js"></script>

</body>
</html>
